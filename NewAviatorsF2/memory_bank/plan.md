# Plan T√©cnico - Fase 2: Funcionalidades Avanzadas
## Plataforma Educativa de Aviaci√≥n

---

## üìã Resumen Ejecutivo

Este documento presenta el plan t√©cnico completo para la **Fase 2** de la plataforma educativa de aviaci√≥n, construida sobre Django (backend) y React (frontend). La fase contempla **39 tareas t√©cnicas** distribuidas en **11 grupos funcionales**, desde refactors estructurales hasta mejoras de UX/UI.

**Alcance total estimado:** 320-450 horas de desarrollo
**Funcionalidades:** 31 caracter√≠sticas nuevas
**Complejidad general:** Media-Alta debido a refactors estructurales

---

## üèóÔ∏è Grupos Funcionales por Complejidad

### üî• GRUPO 1: REFACTORS ESTRUCTURALES (Alta Complejidad)

#### 1.1 Banco de Preguntas PPL
**Complejidad:** üî• Alta | **Estimaci√≥n:** 60-80 horas

**Descripci√≥n:** Incorporar banco de preguntas para licencia PPL, requiriendo abstracci√≥n completa del sistema de licencias.

**Tareas Backend:**
- **Tarea 1.1.1:** Crear abstracci√≥n de licencias
  - Refactorizar modelo `License` para soportar ATPL y PPL
  - Migraci√≥n de datos existentes manteniendo integridad
  - Archivos afectados: `models.py`, migraciones
  - Testing: Unitarios para modelo, integridad de datos

- **Tarea 1.1.2:** Adaptar modelo de preguntas
  - A√±adir campo `license_type` a modelo `Question`
  - Crear relaci√≥n Many-to-Many con licencias
  - Archivos afectados: `models.py`, `serializers.py`
  - Testing: Validaci√≥n de integridad referencial

- **Tarea 1.1.3:** Endpoints espec√≠ficos por licencia
  - Crear endpoints filtrados por tipo de licencia
  - Modificar serializers existentes
  - Archivos afectados: `views.py`, `urls.py`, `serializers.py`
  - Testing: Integraci√≥n de endpoints, permisos

**Tareas Frontend:**
- **Tarea 1.1.4:** Selector de licencia en navegaci√≥n
  - Componente global para cambio de contexto
  - Estado global para licencia activa
  - Archivos afectados: `App.js`, `LicenseContext.js`, components globales
  - Testing: Componente, estado global

- **Tarea 1.1.5:** Filtrado din√°mico en interfaces
  - Adaptar listados de preguntas, ex√°menes, estad√≠sticas
  - Modificar servicios API existentes
  - Archivos afectados: Services, componentes de listado
  - Testing: Integraci√≥n con API, UI

**Riesgos t√©cnicos:**
- Migraci√≥n de datos sin p√©rdida de informaci√≥n
- Impacto en rendimiento por filtrado adicional
- Compatibilidad con sistema de permisos existente

---

#### 1.2 Carpetas para Ex√°menes
**Complejidad:** üî• Alta | **Estimaci√≥n:** 50-70 horas

**Descripci√≥n:** Sistema de organizaci√≥n visual de ex√°menes en carpetas compartidas entre instructores.

**Tareas Backend:**
- **Tarea 1.2.1:** Modelo de carpetas
  - Crear modelo `ExamFolder` con jerarqu√≠a
  - Relaciones con ex√°menes e instructores
  - Archivos afectados: `models.py`, migraciones
  - Testing: Jerarqu√≠a, permisos, integridad

- **Tarea 1.2.2:** Sistema de permisos para carpetas
  - Herencia de permisos padre-hijo
  - Compartir carpetas entre instructores
  - Archivos afectados: `permissions.py`, `views.py`
  - Testing: Casos edge de permisos, herencia

- **Tarea 1.2.3:** Endpoints de gesti√≥n
  - CRUD completo para carpetas
  - Mover ex√°menes entre carpetas
  - Archivos afectados: `views.py`, `serializers.py`, `urls.py`
  - Testing: Operaciones CRUD, validaciones

**Tareas Frontend:**
- **Tarea 1.2.4:** Interfaz de carpetas tipo √°rbol
  - Componente navegable con drag & drop
  - Vista jer√°rquica expandible/colapsable
  - Archivos afectados: `FolderTree.js`, CSS espec√≠fico
  - Testing: Interacci√≥n, drag & drop, performance

- **Tarea 1.2.5:** Gesti√≥n de carpetas
  - Crear, editar, eliminar carpetas
  - Modal de permisos y compartir
  - Archivos afectados: `FolderManager.js`, modales relacionados
  - Testing: CRUD operations, validaciones UI

**Riesgos t√©cnicos:**
- Complejidad de permisos anidados
- Performance con muchas carpetas/ex√°menes
- UX intuitiva para organizaci√≥n

---

### üí™ GRUPO 2: FUNCIONALIDADES CORE (Media-Alta Complejidad)

#### 2.1 Creaci√≥n de Preguntas por Instructores
**Complejidad:** üí™ Media-Alta | **Estimaci√≥n:** 40-55 horas

**Tareas Backend:**
- **Tarea 2.1.1:** Distinci√≥n preguntas oficiales/personalizadas
  - Campo `is_official` en modelo Question
  - Filtros por tipo en queries
  - Archivos afectados: `models.py`, `views.py`, migraciones
  - Testing: Segregaci√≥n de datos, permisos

- **Tarea 2.1.2:** Endpoints para instructores
  - CRUD completo para preguntas personalizadas
  - Validaciones espec√≠ficas para instructores
  - Archivos afectados: `instructor_views.py`, `serializers.py`
  - Testing: Permisos, validaciones, integridad

**Tareas Frontend:**
- **Tarea 2.1.3:** Editor de preguntas
  - Formulario completo con validaciones
  - Preview en tiempo real
  - Archivos afectados: `QuestionEditor.js`, `QuestionPreview.js`
  - Testing: Formulario, validaciones, preview

- **Tarea 2.1.4:** Gesti√≥n de preguntas del instructor
  - Lista, editar, eliminar preguntas propias
  - Filtros y b√∫squeda
  - Archivos afectados: `InstructorQuestions.js`
  - Testing: CRUD, filtros, paginaci√≥n

---

#### 2.2 Editar Ex√°menes Existentes
**Complejidad:** üí™ Media-Alta | **Estimaci√≥n:** 35-50 horas

**Tareas Backend:**
- **Tarea 2.2.1:** Validaciones de edici√≥n
  - Verificar ausencia de intentos/respuestas
  - Estados de examen (draft, active, completed)
  - Archivos afectados: `models.py`, `validators.py`
  - Testing: Edge cases, validaciones

- **Tarea 2.2.2:** Endpoints de edici√≥n
  - Modificar datos b√°sicos del examen
  - A√±adir/quitar alumnos si cumple condiciones
  - Archivos afectados: `exam_views.py`
  - Testing: Condiciones de edici√≥n, permisos

**Tareas Frontend:**
- **Tarea 2.2.3:** Interfaz de edici√≥n
  - Formulario con validaciones contextuales
  - Warnings sobre limitaciones
  - Archivos afectados: `ExamEditor.js`
  - Testing: Validaciones UI, feedback

---

### üé® GRUPO 3: MEJORAS UX/UI (Media Complejidad)

#### 3.1 Modo Oscuro
**Complejidad:** üí° Media | **Estimaci√≥n:** 25-35 horas

**Tareas Frontend:**
- **Tarea 3.1.1:** Sistema de temas
  - Definir variables CSS para tema claro/oscuro
  - Toggle component reutilizable
  - Archivos afectados: `themes.css`, `ThemeToggle.js`
  - Testing: Cambio de tema, persistencia

- **Tarea 3.1.2:** Aplicar tema a toda la aplicaci√≥n
  - Revisar y adaptar todos los componentes
  - Verificar contraste y accesibilidad
  - Archivos afectados: Todos los CSS/styled-components
  - Testing: Visual regression, accesibilidad

**Tareas Backend:**
- **Tarea 3.1.3:** Preferencia de usuario
  - Campo `theme_preference` en perfil
  - Endpoint para guardar preferencia
  - Archivos afectados: `User model`, `profile_views.py`
  - Testing: Persistencia, API

---

#### 3.2 Navegaci√≥n por Teclado
**Complejidad:** üí° Media | **Estimaci√≥n:** 20-30 horas

**Tareas Frontend:**
- **Tarea 3.2.1:** Atajos en m√≥dulo de ex√°menes
  - Navegaci√≥n entre preguntas (‚Üê‚Üí)
  - Selecci√≥n de respuestas (1,2,3,4)
  - Submit y navegaci√≥n (Enter, Space)
  - Archivos afectados: `ExamInterface.js`, `QuestionComponent.js`
  - Testing: Eventos teclado, accesibilidad

- **Tarea 3.2.2:** Indicadores visuales
  - Mostrar atajos disponibles
  - Feedback visual de navegaci√≥n
  - Archivos afectados: `KeyboardHints.js`
  - Testing: Visibilidad, UX

---

#### 3.3 E6B Integrado
**Complejidad:** üí° Media | **Estimaci√≥n:** 30-40 horas

**Tareas Frontend:**
- **Tarea 3.3.1:** Calculadora E6B nativa
  - Implementar funciones de c√°lculo aeron√°utico
  - Interfaz visual similar a E6B f√≠sico
  - Archivos afectados: `E6BCalculator.js`, c√°lculos espec√≠ficos
  - Testing: Precisi√≥n de c√°lculos, UI

- **Tarea 3.3.2:** Integraci√≥n en plataforma
  - Modal/sidebar accesible desde ex√°menes
  - Persistir estado durante uso
  - Archivos afectados: `ExamLayout.js`
  - Testing: Integraci√≥n, persistencia estado

---

#### 3.4 Herramientas de Estudio

##### 3.4.1 Anotaciones Personales
**Complejidad:** üí° Media | **Estimaci√≥n:** 25-35 horas

**Tareas Backend:**
- **Tarea 3.4.1.1:** Modelo de anotaciones
  - Relaci√≥n Usuario-Pregunta-Nota
  - Texto rico opcional
  - Archivos afectados: `models.py`, migraciones
  - Testing: Relaciones, validaciones

- **Tarea 3.4.1.2:** Endpoints de anotaciones
  - CRUD para notas personales
  - Archivos afectados: `notes_views.py`
  - Testing: Permisos, CRUD

**Tareas Frontend:**
- **Tarea 3.4.1.3:** Editor de notas
  - Componente para a√±adir/editar notas
  - Rich text editor b√°sico
  - Archivos afectados: `NoteEditor.js`
  - Testing: Editor, persistencia

##### 3.4.2 Flags Multicolor
**Complejidad:** üí° Media | **Estimaci√≥n:** 20-25 horas

**Tareas Backend:**
- **Tarea 3.4.2.1:** Modelo de flags
  - Usuario-Pregunta-Color
  - Preset de colores disponibles
  - Archivos afectados: `models.py`
  - Testing: Relaciones, colores v√°lidos

**Tareas Frontend:**
- **Tarea 3.4.2.2:** Sistema de marcado
  - Selector de colores en preguntas
  - Filtros por color en listados
  - Archivos afectados: `QuestionFlag.js`, `ColorPicker.js`
  - Testing: Marcado, filtros

---

### üë• GRUPO 4: INTERACCI√ìN SOCIAL (Media Complejidad)

#### 4.1 Comentarios P√∫blicos
**Complejidad:** üí° Media | **Estimaci√≥n:** 30-40 horas

**Tareas Backend:**
- **Tarea 4.1.1:** Modelo de comentarios
  - Usuario-Pregunta-Comentario
  - Sistema b√°sico de moderaci√≥n
  - Archivos afectados: `models.py`, migraciones
  - Testing: Relaciones, moderaci√≥n

- **Tarea 4.1.2:** Endpoints y moderaci√≥n
  - CRUD para comentarios
  - Endpoints para moderadores
  - Archivos afectados: `comments_views.py`
  - Testing: Permisos, moderaci√≥n

**Tareas Frontend:**
- **Tarea 4.1.3:** Interfaz de comentarios
  - Lista de comentarios por pregunta
  - Formulario de nuevo comentario
  - Archivos afectados: `Comments.js`, `CommentForm.js`
  - Testing: CRUD, actualizaci√≥n tiempo real

- **Tarea 4.1.4:** Panel de moderaci√≥n
  - Lista de comentarios reportados
  - Acciones de moderaci√≥n
  - Archivos afectados: `ModerationPanel.js`
  - Testing: Permisos moderador, acciones

---

### üë®‚Äçüè´ GRUPO 5: FUNCIONALIDADES PARA INSTRUCTORES (Media Complejidad)

#### 5.1 Vista Previa Completa en Progress Test
**Complejidad:** üí° Media | **Estimaci√≥n:** 15-20 horas

**Tareas Frontend:**
- **Tarea 5.1.1:** Mejorar UI de selecci√≥n
  - Mostrar enunciado completo en selector
  - Preview expandible de preguntas
  - Archivos afectados: `QuestionSelector.js`
  - Testing: UI, performance con muchas preguntas

---

#### 5.2 Instructores Realizando Tests
**Complejidad:** üí° Media | **Estimaci√≥n:** 20-25 horas

**Tareas Backend:**
- **Tarea 5.2.1:** Permisos para instructores
  - Modificar l√≥gica de acceso a tests
  - Rol mixto alumno-instructor
  - Archivos afectados: `permissions.py`, `test_views.py`
  - Testing: Permisos, roles

**Tareas Frontend:**
- **Tarea 5.2.2:** Interfaz unificada
  - Reutilizar componentes de test de alumnos
  - Adaptaciones menores para instructores
  - Archivos afectados: `TestInterface.js`
  - Testing: Reutilizaci√≥n componentes

---

### üë§ GRUPO 6: GESTI√ìN DE USUARIOS (Baja Complejidad)

#### 6.1 Gesti√≥n de Errores al Crear Usuario
**Complejidad:** üíö Baja | **Estimaci√≥n:** 8-12 horas

**Tareas Backend:**
- **Tarea 6.1.1:** Validaciones mejoradas
  - Validar email duplicado
  - Mensajes de error espec√≠ficos
  - Archivos afectados: `serializers.py`, `validators.py`
  - Testing: Validaciones, mensajes error

**Tareas Frontend:**
- **Tarea 6.1.2:** Feedback de errores
  - Mostrar errores espec√≠ficos en formulario
  - Archivos afectados: `UserForm.js`
  - Testing: Display errores, UX

---

#### 6.2 Ordenaci√≥n y Filtros en Paginaci√≥n
**Complejidad:** üíö Baja | **Estimaci√≥n:** 12-15 horas

**Tareas Backend:**
- **Tarea 6.2.1:** Ordenaci√≥n global
  - Implementar ordenaci√≥n antes de paginar
  - Filtros que apliquen al queryset completo
  - Archivos afectados: `views.py`, `filters.py`
  - Testing: Ordenaci√≥n, filtros, paginaci√≥n

**Tareas Frontend:**
- **Tarea 6.2.2:** Controles de ordenaci√≥n
  - Headers clickeables para ordenar
  - Indicadores visuales de orden actual
  - Archivos afectados: `UserTable.js`
  - Testing: Interacci√≥n ordenaci√≥n

---

#### 6.3 Editar Perfiles
**Complejidad:** üíö Baja | **Estimaci√≥n:** 10-15 horas

**Tareas Backend:**
- **Tarea 6.3.1:** Cambio de rol
  - Endpoint para modificar rol usuario
  - Validaciones de permisos
  - Archivos afectados: `user_views.py`
  - Testing: Cambio rol, permisos

**Tareas Frontend:**
- **Tarea 6.3.2:** Interfaz edici√≥n perfil
  - Formulario con selector de rol
  - Archivos afectados: `ProfileEditor.js`
  - Testing: Formulario, validaciones

---

#### 6.4 Mostrar Informaci√≥n Adicional en Lista
**Complejidad:** üíö Baja | **Estimaci√≥n:** 6-10 horas

**Tareas Backend:**
- **Tarea 6.4.1:** Serializer ampliado
  - Incluir nombre, apellido, grupo en listado
  - Archivos afectados: `serializers.py`
  - Testing: Datos en respuesta

**Tareas Frontend:**
- **Tarea 6.4.2:** Columnas adicionales
  - Mostrar nueva informaci√≥n en tabla
  - Archivos afectados: `UserTable.js`
  - Testing: Display informaci√≥n

---

### üìä GRUPO 7: M√âTRICAS Y REPORTES (Media Complejidad)

#### 7.1 Revisar M√©tricas
**Complejidad:** üí° Media | **Estimaci√≥n:** 20-30 horas

**Tareas Backend:**
- **Tarea 7.1.1:** Refactor c√°lculos
  - Revisar l√≥gica de "total time"
  - Optimizar queries de m√©tricas
  - Archivos afectados: `metrics.py`, `views.py`
  - Testing: Precisi√≥n de c√°lculos

**Tareas Frontend:**
- **Tarea 7.1.2:** Visualizaci√≥n mejorada
  - Componentes de m√©tricas m√°s claros
  - Archivos afectados: `MetricsDisplay.js`
  - Testing: Visualizaci√≥n, precisi√≥n datos

---

### üìã GRUPO 8: HISTORIAL Y REPORTES (Baja Complejidad)

#### 8.1 Historial Completo de Alumno
**Complejidad:** üíö Baja | **Estimaci√≥n:** 8-12 horas

**Tareas Backend:**
- **Tarea 8.1.1:** Query ampliado
  - Incluir ex√°menes de todos los grupos
  - Archivos afectados: `student_views.py`
  - Testing: Datos completos

---

#### 8.2 Reportes PDF Mejorados
**Complejidad:** üíö Baja | **Estimaci√≥n:** 12-18 horas

**Tareas Backend:**
- **Tarea 8.2.1:** PDF con nombre alumno
  - A√±adir nombre en header del PDF
  - Endpoint para descarga individual
  - Archivos afectados: `pdf_generator.py`, `report_views.py`
  - Testing: Generaci√≥n PDF, datos correctos

---

### üìù GRUPO 9: MEJORAS EN EX√ÅMENES (Baja-Media Complejidad)

#### 9.1 Permisos en Ex√°menes
**Complejidad:** üí° Media | **Estimaci√≥n:** 15-20 horas

**Tareas Backend:**
- **Tarea 9.1.1:** Sistema de permisos refinado
  - Distinguir entre instructor y admin
  - Archivos afectados: `permissions.py`
  - Testing: Permisos por rol

---

#### 9.2 Mejoras en Selector de Preguntas
**Complejidad:** üí° Media | **Estimaci√≥n:** 18-25 horas

**Tareas Frontend:**
- **Tarea 9.2.1:** Bot√≥n "Seleccionar todo"
  - Implementar selecci√≥n masiva
  - Archivos afectados: `QuestionSelector.js`
  - Testing: Selecci√≥n masiva

- **Tarea 9.2.2:** Vista previa mejorada
  - Enunciado completo antes de seleccionar
  - Archivos afectados: `QuestionPreview.js`
  - Testing: Preview, performance

---

#### 9.3 C√≥digos de Colores y Aleatoriedad
**Complejidad:** üíö Baja | **Estimaci√≥n:** 10-15 horas

**Tareas Frontend:**
- **Tarea 9.3.1:** Colores por % acierto
  - Verde >75%, amarillo 50-75%, rojo <50%
  - Archivos afectados: `QuestionStatus.js`
  - Testing: L√≥gica colores

**Tareas Backend:**
- **Tarea 9.3.2:** Aleatoriedad mejorada
  - Asegurar respeto a temas seleccionados
  - Archivos afectados: `exam_generator.py`
  - Testing: Distribuci√≥n aleatoria

---

#### 9.4 Ordenaci√≥n de Syllabus
**Complejidad:** üí° Media | **Estimaci√≥n:** 12-18 horas

**Tareas Backend:**
- **Tarea 9.4.1:** Orden configurable
  - Campo `order` en modelo Topic/Theme
  - Archivos afectados: `models.py`
  - Testing: Ordenaci√≥n

**Tareas Frontend:**
- **Tarea 9.4.2:** Interfaz de ordenaci√≥n
  - Drag & drop para reordenar temas
  - Archivos afectados: `TopicOrganizer.js`
  - Testing: Drag & drop, persistencia

---

### üì± GRUPO 10: RESPONSIVE Y UI (Baja Complejidad)

#### 10.1 Men√∫ Responsive
**Complejidad:** üíö Baja | **Estimaci√≥n:** 8-12 horas

**Tareas Frontend:**
- **Tarea 10.1.1:** Ajustes iPad vertical
  - Media queries espec√≠ficas
  - Archivos afectados: `Navigation.css`
  - Testing: Responsive en iPad

---

#### 10.2 Selector y Contador Mobile
**Complejidad:** üíö Baja | **Estimaci√≥n:** 10-15 horas

**Tareas Frontend:**
- **Tarea 10.2.1:** UX mobile mejorada
  - Componentes optimizados para m√≥vil
  - Archivos afectados: `QuestionCounter.js`, `QuestionSelector.js`
  - Testing: UX m√≥vil

---

## üìä Resumen de Estimaciones

### Por Complejidad
- **üî• Alta:** 110-150 horas (2 funcionalidades)
- **üí™ Media-Alta:** 75-105 horas (2 funcionalidades)  
- **üí° Media:** 135-195 horas (21 funcionalidades)
- **üíö Baja:** 84-127 horas (6 funcionalidades)

### Por Grupo Funcional
1. **Refactors Estructurales:** 110-150h
2. **Funcionalidades Core:** 75-105h
3. **Mejoras UX/UI:** 120-165h
4. **Interacci√≥n Social:** 30-40h
5. **Funcionalidades Instructores:** 35-45h
6. **Gesti√≥n Usuarios:** 36-52h
7. **M√©tricas:** 20-30h
8. **Reportes:** 20-30h
9. **Mejoras Ex√°menes:** 55-78h
10. **Responsive:** 18-27h

**TOTAL ESTIMADO: 519-722 horas**

---

## üö® Riesgos T√©cnicos Principales

### Alto Riesgo
1. **Migraci√≥n de datos** en refactor de licencias
2. **Performance** con sistema de carpetas jer√°rquicas
3. **Compatibilidad** con sistema de permisos existente

### Riesgo Medio
1. **Complejidad de permisos** anidados en carpetas
2. **Estados concurrentes** en edici√≥n de ex√°menes
3. **Integraci√≥n** de modo oscuro sin romper componentes

### Riesgo Bajo
1. **Regresiones visuales** en cambios de UI
2. **Performance** en dispositivos m√≥viles
3. **Compatibilidad** entre navegadores

---

## üéØ Dependencias Cr√≠ticas

### Secuenciales (Deben completarse en orden)
1. **Banco PPL** ‚Üí Todas las funcionalidades que usen preguntas
2. **Carpetas** ‚Üí Gesti√≥n avanzada de ex√°menes
3. **Modo oscuro** ‚Üí Todas las mejoras visuales posteriores

### Paralelas (Pueden desarrollarse simult√°neamente)
- Herramientas de estudio (anotaciones, flags)
- Mejoras de gesti√≥n de usuarios
- Sistema de comentarios
- Reportes y m√©tricas

---

## üìã Plan de Testing

### Testing por Fase
1. **Unitario:** Cada modelo y funci√≥n nueva
2. **Integraci√≥n:** APIs y componentes complejos
3. **E2E:** Flujos cr√≠ticos (crear examen, realizar test)
4. **Visual:** Regresi√≥n en cambios de UI
5. **Performance:** Consultas complejas y componentes pesados

### Cobertura M√≠nima
- **Backend:** 85% cobertura en funcionalidades nuevas
- **Frontend:** Testing de componentes cr√≠ticos
- **E2E:** Flujos principales de usuario

---

## üöÄ Recomendaciones de Implementaci√≥n

### Fase 1 (Cr√≠tica - 2-3 meses)
- Banco PPL (refactor estructural)
- Carpetas para ex√°menes
- Modo oscuro b√°sico

### Fase 2 (Core - 1-2 meses)  
- Creaci√≥n de preguntas por instructores
- Herramientas de estudio (anotaciones, flags)
- Mejoras en gesti√≥n de usuarios

### Fase 3 (Mejoras - 1-2 meses)
- E6B integrado
- Comentarios p√∫blicos
- Navegaci√≥n por teclado
- Mejoras en ex√°menes

### Fase 4 (Pulido - 1 mes)
- Responsive final
- M√©tricas optimizadas
- Reportes mejorados
- Testing exhaustivo

---

*Documento generado para Fase 2 - Plataforma Educativa de Aviaci√≥n*
*√öltima actualizaci√≥n: [Fecha actual]*